version: "3"

services:
    visualizador:
        image: dockersamples/visualizer
        volumes:
            - "/var/run/docker.sock:/var/run/docker.sock"
        ports:
            - 8080:8080
        deploy:
            placement:
                constraints:
                    - node.role == manager
    core-api:
        image: matheusgimenez/apimovingtipscore
        ports:
            - "3000:80"
        deploy:
            replicas: 3
            restart_policy:
                condition: on-failure
                max_attempts: 3
        networks:
            - movingTips
    
    district-api:
        image: matheusgimenez/apimovingtipsdistrict
        ports:
            - "3001:80"
        deploy:
            replicas: 3
            restart_policy:
                condition: on-failure
                max_attempts: 3
        networks:
            - movingTips
        
networks: 
    movingTips:
        external: true
        driver: bridge